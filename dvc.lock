schema: '2.0'
stages:
  prepare_data:
    cmd: python backend/src/ml_pipeline/data_pipeline/prepare_data.py --root-dir
      backend/public/data --output-file 
      backend/public/processed/annotations.json
    deps:
    - path: backend/public/data/good
      hash: md5
      md5: d8211d1f21b4e06ccf7d9c325260b10a.dir
      size: 29045139
      nfiles: 20
    - path: backend/public/data/ground_truth_1
      hash: md5
      md5: deb86fbeaaa071e34f8be0e7c2c834ad.dir
      size: 2988211
      nfiles: 800
    - path: backend/public/data/ground_truth_2
      hash: md5
      md5: 1e20fca65f03f1b1d369c909a8b2cd1e.dir
      size: 1626047
      nfiles: 400
    - path: backend/public/data/oil
      hash: md5
      md5: b469eebe095d9b13f49965fb5a33e526.dir
      size: 568650446
      nfiles: 400
    - path: backend/public/data/scratch
      hash: md5
      md5: 72a61ad1a0fdb6d4e670824ff7e26721.dir
      size: 544330282
      nfiles: 400
    - path: backend/public/data/stain
      hash: md5
      md5: d8032848cdcc89a78225b813095e9672.dir
      size: 579635334
      nfiles: 400
    - path: backend/src/ml_pipeline/data_pipeline/prepare_data.py
      hash: md5
      md5: 224ad85333a2b80f789c2b70a5b5d9bc
      size: 6904
    outs:
    - path: backend/public/processed/annotations.json
      hash: md5
      md5: bb668c3c157a92a4676f0604ae4c7cfc
      size: 106576477
  split_data:
    cmd: python backend/src/ml_pipeline/data_pipeline/split_data.py --params 
      params.yaml
    deps:
    - path: backend/public/processed/annotations.json
      hash: md5
      md5: bb668c3c157a92a4676f0604ae4c7cfc
      size: 106576477
    - path: backend/src/ml_pipeline/data_pipeline/split_data.py
      hash: md5
      md5: f152ef77d9a2c0ad52b42c3ed2205fb5
      size: 1493
    params:
      params.yaml:
        split:
          test_size: 0.2
          random_state: 42
          train_output: backend/public/processed/train_ids.json
          valid_output: backend/public/processed/valid_ids.json
    outs:
    - path: backend/public/processed/train_ids.json
      hash: md5
      md5: fee7abbeda0713defa89c6384fd8d125
      size: 4772
    - path: backend/public/processed/valid_ids.json
      hash: md5
      md5: 744149cf634ac121fcb724ee8ff8950b
      size: 1441
  data_collection:
    cmd: python backend/src/ml_pipeline/data_pipeline/data_collection.py
    deps:
    - path: backend/src/ml_pipeline/data_pipeline/data_collection.py
      hash: md5
      md5: b5ff30cdcff89bd3883086c010c773a6
      size: 772
    outs:
    - path: backend/public/labelling
      hash: md5
      md5: 6f64628654a59bcd6eb86e0676502f89.dir
      size: 23482
      nfiles: 2
  data_extraction:
    cmd: python backend/src/ml_pipeline/data_pipeline/data_extraction.py 
      --params params.yaml
    deps:
    - path: backend/public/labelling
      hash: md5
      md5: 6f64628654a59bcd6eb86e0676502f89.dir
      size: 23482
      nfiles: 2
    - path: backend/src/ml_pipeline/data_pipeline/data_extraction.py
      hash: md5
      md5: a4d95c60199b9ddd0b154d4d6c7b5827
      size: 6533
    params:
      params.yaml:
        path:
          data_path: backend/public/data
          annotation_path: backend/public/processed/annotations.json
    outs:
    - path: backend/public/processed/annotations.json
      hash: md5
      md5: 3300f6c190a37f9a614ae8fe0e4e42de
      size: 106576507
  data_processing:
    cmd: python backend/src/ml_pipeline/data_pipeline/data_processing.py 
      --params params.yaml
    deps:
    - path: backend/public/processed/annotations.json
      hash: md5
      md5: ff0190fb324d2ad78d37056268d83283
      size: 106576477
    - path: backend/src/ml_pipeline/data_pipeline/data_processing.py
      hash: md5
      md5: a9c0e99cfaee0b08653a4a2488c61653
      size: 1517
    params:
      params.yaml:
        train_valid:
          test_size: 0.2
          random_state: 42
          train_output: backend/public/processed/train_ids.json
          valid_output: backend/public/processed/valid_ids.json
    outs:
    - path: backend/public/processed/train_ids.json
      hash: md5
      md5: fee7abbeda0713defa89c6384fd8d125
      size: 4772
    - path: backend/public/processed/valid_ids.json
      hash: md5
      md5: 744149cf634ac121fcb724ee8ff8950b
      size: 1441
  data_annotation:
    cmd: python backend/src/ml_pipeline/data_pipeline/data_extraction.py 
      --params params.yaml
    deps:
    - path: backend/public/data
      hash: md5
      md5: add17345a04000898f3b6ffa28db54a1.dir
      size: 1726275459
      nfiles: 2420
    outs:
    - path: backend/public/processed/annotations.json
      hash: md5
      md5: ff0190fb324d2ad78d37056268d83283
      size: 106576477
  main:
    cmd: python -m backend.src.ml_pipeline.main
    deps:
    - path: backend/public/processed/train_ids.json
      hash: md5
      md5: fee7abbeda0713defa89c6384fd8d125
      size: 4772
    - path: backend/public/processed/valid_ids.json
      hash: md5
      md5: 744149cf634ac121fcb724ee8ff8950b
      size: 1441
    - path: backend/src/ml_pipeline/main.py
      hash: md5
      md5: 7c324339110c3072edc5692162f3f4a6
      size: 3748
